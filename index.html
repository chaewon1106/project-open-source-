<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Profile Card</title>
  
  <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  
  <style>
    :root {
      --bg-color: #F8FAFC;
      --panel-bg: rgba(255, 255, 255, 0.95);
      --primary: #8cb6f5; /* íŒŒìŠ¤í…” ë¸”ë£¨ */
      --primary-hover: #7ba3e0;
      --text-main: #0f172a;
      --text-sub: #64748b;
      --border-color: #e2e8f0;
      --shadow: 0 4px 20px rgba(0,0,0,0.05);
      --input-bg: #ffffff;
    }

    * { box-sizing: border-box; }
    
    body {
      font-family: "Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0; min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      background-color: var(--bg-color);
      color: var(--text-main);
      overflow-x: hidden;
      padding-bottom: 40px; 
    }

    .mesh-bg {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: -1;
      background: radial-gradient(circle at 50% 50%, #f1f5f9 0%, #dfe7f2 100%);
    }

    .wrap { width: min(460px, 92%); padding: 40px 0; position: relative; z-index: 1; }

    /* íŒ¨ë„ ê³µí†µ ìŠ¤íƒ€ì¼ */
    .clean-panel {
      background: var(--panel-bg); backdrop-filter: blur(10px);
      border: 1px solid var(--border-color); border-radius: 20px; padding: 32px 28px;
      box-shadow: var(--shadow);
    }

    /* ì¸íŠ¸ë¡œ ì „ìš© ìŠ¤íƒ€ì¼ */
    #viewIntro { text-align: center; padding: 60px 20px; }
    
    /* 3ë²ˆ: ì…ì²´ì ì¸ ì¹´ë“œ ìŠ¤íƒ€ì¼ SVG */
    .intro-svg-container {
      display: flex; justify-content: center; margin-bottom: 30px;
    }
    .intro-svg { 
      animation: float 3s ease-in-out infinite; 
    }
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
    
    .main-title { font-size: 28px; font-weight: 800; margin: 0 0 10px; color: #0f172a; letter-spacing: -0.5px; }
    .sub-title { margin: 0 0 40px; color: var(--text-sub); font-size: 16px; line-height: 1.5; }
    
    /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ (íŒŒìŠ¤í…” í†¤ ì ìš©) */
    .btn-start {
      width: 100%; max-width: 240px; padding: 18px; border-radius: 12px;
      background: var(--primary); color: white; font-size: 16px; font-weight: 700;
      border: none;
      box-shadow: 0 4px 12px rgba(140, 182, 245, 0.4); 
      transition: transform 0.2s, background 0.2s;
    }
    .btn-start:hover { background: var(--primary-hover); transform: translateY(-2px); }

    /* í™”ë©´ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
    .fade-enter { animation: fadeUp 0.4s ease-out forwards; }
    @keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* í¼ ìŠ¤íƒ€ì¼ */
    .form-header { text-align: center; margin-bottom: 32px; }
    .form-header .main-title { font-size: 24px; margin-bottom: 6px; }
    .form-header .sub-title { font-size: 15px; margin-bottom: 0; }
    
    .form-group { margin-bottom: 24px; }
    label { display: block; font-size: 13px; font-weight: 600; color: var(--text-sub); margin-bottom: 8px; }
    .input-wrapper { display: flex; align-items: center; gap: 8px; }

    input[type="text"], select, input[type="file"] {
      width: 100%; padding: 12px 14px; background: var(--input-bg);
      border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-main); font-size: 14px;
      transition: all 0.2s;
    }
    input:focus, select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 2px rgba(140, 182, 245, 0.2); }
    
    .color-grid { display: flex; gap: 12px; padding: 4px 0; justify-content: center; }
    .color-swatch {
      width: 36px; height: 36px; border-radius: 50%; cursor: pointer;
      border: 2px solid white; box-shadow: 0 2px 6px rgba(0,0,0,0.1); transition: transform 0.2s;
    }
    .color-swatch:hover { transform: translateY(-2px); }
    .color-swatch.active { transform: scale(1.1); border-color: var(--text-main); }

    .bg-ocean { background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%); color: #0c4a6e; }
    .bg-peach { background: linear-gradient(135deg, #ffe4e6 0%, #fecdd3 100%); color: #881337; }
    .bg-mint { background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); color: #14532d; }
    .bg-gray { background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%); color: #1e293b; }
    .bg-indigo { background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%); color: #312e81; }

    button { cursor: pointer; font-family: inherit; border: none; }
    .btn-rand {
      width: 50px; height: 43px; flex-shrink: 0; border-radius: 8px;
      background: #f8fafc; color: #64748b; font-size: 13px; font-weight: 600;
      border: 1px solid var(--border-color); transition: 0.2s;
    }
    .btn-rand:hover { background: #fff; color: var(--primary); border-color: var(--primary); }

    .btn-primary {
      width: 100%; padding: 16px; margin-top: 16px; border-radius: 10px;
      background: var(--text-main); color: white; font-size: 15px; font-weight: 600; transition: background 0.2s;
    }
    .btn-primary:hover { background: #334155; }

    /* ê²°ê³¼ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .id-card-wrapper { padding: 10px; margin-bottom: 24px; }
    .id-card {
      position: relative; overflow: hidden; border-radius: 20px; padding: 40px 30px; text-align: center;
      box-shadow: 0 20px 40px rgba(0,0,0,0.08); transition: all 0.3s ease;
    }
    
    .avatar-frame {
      width: 100px; height: 100px; margin: 0 auto 20px; border-radius: 50%;
      background: rgba(255,255,255,0.5); overflow: hidden;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .avatar-img {
      width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;
      font-size: 32px; font-weight: 700; background: rgba(255,255,255,0.8); color: inherit;
    }
    .avatar-img img { width: 100%; height: 100%; object-fit: cover; display: block; }
    
    .card-name { font-size: 22px; font-weight: 800; margin: 0 0 6px; color: inherit; }
    .card-mbti {
      display: inline-block; font-size: 12px; font-weight: 600;
      background: rgba(255,255,255,0.4); color: inherit;
      padding: 4px 10px; border-radius: 4px; margin-bottom: 20px;
    }

    .card-tags { display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; margin-bottom: 24px; }
    .tag {
      font-size: 12px; background: rgba(255,255,255,0.5);
      padding: 6px 12px; border-radius: 100px; color: inherit; font-weight: 500;
    }

    .card-desc {
      background: rgba(255,255,255,0.7); padding: 20px; border-radius: 12px;
      font-size: 14px; line-height: 1.6; color: #334155; text-align: left; word-break: keep-all;
    }

    .action-group { display: flex; gap: 8px; margin-bottom: 16px; }
    .btn-secondary {
      flex: 1; padding: 14px; border-radius: 10px; background: white; border: 1px solid var(--border-color);
      color: #475569; font-weight: 500; font-size: 14px; transition: 0.2s;
    }
    .btn-secondary:hover { background: #f8fafc; border-color: #cbd5e1; }
    .btn-download { background: var(--text-main); color: white; border: 1px solid var(--text-main); }
    .btn-download:hover { background: #334155; }
    .btn-text { width: 100%; background: none; color: #94a3b8; font-size: 13px; text-decoration: underline; padding: 10px; }
    
    .hidden { display: none !important; }

    /* Toast Notification */
    #toast {
      visibility: hidden; min-width: 250px; margin-left: -125px;
      background-color: rgba(15, 23, 42, 0.9); color: #fff; text-align: center;
      border-radius: 50px; padding: 12px; position: fixed; z-index: 100;
      left: 50%; bottom: 30px; font-size: 14px; font-weight: 500;
      opacity: 0; transition: opacity 0.3s, bottom 0.3s; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    #toast.show { visibility: visible; opacity: 1; bottom: 40px; }
  </style>
</head>
<body>

<div class="mesh-bg"></div>
<div id="toast">ì•Œë¦¼ ë©”ì‹œì§€</div>

<div class="wrap">
  
  <section id="viewIntro" class="clean-panel fade-enter">
    <div class="intro-svg-container">
        <svg class="intro-svg" width="120" height="120" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g transform="rotate(-8 50 50)">
                <rect x="28" y="25" width="56" height="72" rx="8" fill="#cbd5e1" />
                <rect x="24" y="21" width="56" height="72" rx="8" fill="url(#card_grad)" stroke="white" stroke-width="2"/>
                <circle cx="52" cy="48" r="14" fill="white" fill-opacity="0.5"/>
                <rect x="38" y="70" width="28" height="4" rx="2" fill="white" fill-opacity="0.6"/>
            </g>
            <defs>
                <linearGradient id="card_grad" x1="24" y1="21" x2="80" y2="93" gradientUnits="userSpaceOnUse">
                    <stop stop-color="#bae6fd"/>
                    <stop offset="1" stop-color="#e0f2fe"/>
                </linearGradient>
            </defs>
        </svg>
    </div>
    
    <h1 class="main-title">í”„ë¡œí•„ ìƒì„±ê¸°</h1>
    <p class="sub-title">ë‹´ë°±í•˜ê³  ê¹”ë”í•œ ë‚˜ë§Œì˜ ì†Œê°œ ì¹´ë“œë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”.</p>
    <button id="startBtn" class="btn-start">í”„ë¡œí•„ ìƒì„±</button>
  </section>

  <section id="viewForm" class="clean-panel hidden">
    <div class="form-header">
      <h1 class="main-title">í”„ë¡œí•„ ìƒì„±ê¸°</h1>
      <p class="sub-title">ë‹´ë°±í•˜ê³  ê¹”ë”í•œ ë‚˜ë§Œì˜ ì†Œê°œ</p>
    </div>
    <form id="profileForm">
      <div class="form-group">
        <label>ì´ë¦„</label>
        <div class="input-wrapper">
          <input type="text" id="name" placeholder="ë³¸ëª… ë˜ëŠ” ë‹‰ë„¤ì„" required autocomplete="off">
        </div>
      </div>

      <div class="form-group">
        <label>í”„ë¡œí•„ ì‚¬ì§„</label>
        <input type="file" id="profileImg" accept="image/*">
      </div>

      <div class="form-group">
        <label style="margin-bottom:12px;">ì¹´ë“œ ìƒ‰ìƒ</label>
        <div class="color-grid">
          <div class="color-swatch bg-ocean active" data-theme="bg-ocean"></div>
          <div class="color-swatch bg-peach" data-theme="bg-peach"></div>
          <div class="color-swatch bg-mint" data-theme="bg-mint"></div>
          <div class="color-swatch bg-indigo" data-theme="bg-indigo"></div>
          <div class="color-swatch bg-gray" data-theme="bg-gray"></div>
        </div>
      </div>

      <div class="form-group">
        <label>MBTI</label>
        <div class="input-wrapper">
          <input type="text" id="mbti" placeholder="ì˜ˆ: ENTP, ISFP..." style="text-transform:uppercase;">
          <button type="button" id="btnRandMbti" class="btn-rand">ëœë¤</button>
        </div>
      </div>

      <div class="form-group">
        <label>ì¢‹ì•„í•˜ëŠ” ìŒì‹</label>
        <div class="input-wrapper">
          <input type="text" id="food" placeholder="ì˜ˆ: ê¹€ì¹˜ì°Œê°œ, íŒŒìŠ¤íƒ€...">
          <button type="button" id="btnRandFood" class="btn-rand">ëœë¤</button>
        </div>
      </div>

      <div class="form-group">
        <label>ì·¨ë¯¸ / ê´€ì‹¬ì‚¬</label>
        <div class="input-wrapper">
          <input type="text" id="hobby" placeholder="ì˜ˆ: ë…ì„œ, ì½”ë”©...">
          <button type="button" id="btnRandHobby" class="btn-rand">ëœë¤</button>
        </div>
      </div>

      <div class="form-group">
        <label>ì—°ë½ ì„ í˜¸ ì‹œê°„</label>
        <select id="contactTime">
          <option value="any">ìƒê´€ì—†ìŒ</option>
          <option value="day">ë‚® (09:00 - 18:00)</option>
          <option value="night">ë°¤ (18:00 - 24:00)</option>
        </select>
      </div>

      <div class="form-group">
        <label>ë¬¸ì²´ ì„ íƒ</label>
        <select id="tone">
          <option value="polite">ì°¨ë¶„í•˜ê³  ê³µì†í•˜ê²Œ (ë¹„ì§€ë‹ˆìŠ¤ìš©)</option>
          <option value="casual">ì¹œê·¼í•˜ê³  ìì—°ìŠ¤ëŸ½ê²Œ (ì¼ìƒìš©)</option>
          <option value="brief">ê°„ê²°í•˜ê³  ëª…í™•í•˜ê²Œ (ì •ë³´ìœ„ì£¼)</option>
          <option value="emotional">ì•„ë ¨í•˜ê³  ê°ì„±ì ì´ê²Œ (snsìš©)</option>
        </select>
      </div>

      <button type="submit" class="btn-primary">ì¹´ë“œ ë§Œë“¤ê¸°</button>
    </form>
  </section>

  <section id="viewResult" class="hidden">
    <div id="captureTarget" class="id-card-wrapper">
      <div class="id-card" id="cardElement">
        <div class="card-content">
          <div class="avatar-frame">
            <div class="avatar-img" id="rAvatar"></div>
          </div>
          <h2 class="card-name" id="rName"></h2>
          <span class="card-mbti" id="rMbti"></span>
          <div class="card-tags" id="rTags"></div>
          <div class="card-desc" id="rDesc"></div>
        </div>
      </div>
    </div>

    <div class="action-group">
      <button class="btn-secondary" id="copyBtn">í…ìŠ¤íŠ¸ ë³µì‚¬</button>
      <button class="btn-secondary" id="shareBtn">ê³µìœ í•˜ê¸°</button>
      <button class="btn-secondary btn-download" id="downloadBtn">ì €ì¥</button>
    </div>
    <button class="btn-text" id="backBtn">ë‹¤ì‹œ ë§Œë“¤ê¸°</button>
  </section>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // [ìƒíƒœ ë³€ìˆ˜]
  let uploadedImageSrc = null;
  let selectedTheme = 'bg-ocean';

  // [Helper]
  const $ = id => document.getElementById(id);
  const pick = arr => arr[Math.floor(Math.random() * arr.length)];
  
  function showToast(msg) {
    const t = $('toast');
    t.textContent = msg;
    t.className = 'show';
    setTimeout(() => { t.className = t.className.replace('show', ''); }, 2500);
  }

  // [í™”ë©´ ì „í™˜ í•¨ìˆ˜]
  function switchView(fromId, toId) {
    const fromEl = $(fromId);
    const toEl = $(toId);
    
    fromEl.style.opacity = '0';
    setTimeout(() => {
      fromEl.classList.add('hidden');
      toEl.classList.remove('hidden');
      toEl.classList.add('fade-enter');
      toEl.style.opacity = '1'; 
      window.scrollTo(0, 0);
    }, 200);
  }

  // [Intro -> Form]
  $('startBtn').addEventListener('click', () => {
    switchView('viewIntro', 'viewForm');
  });

  const dataBank = {
    mbti: ['ISTJ','ISFJ','INFJ','INTJ','ISTP','ISFP','INFP','INTP','ESTP','ESFP','ENFP','ENTP','ESTJ','ESFJ','ENFJ','ENTJ'],
    foods: ['ê¹€ì¹˜ì°Œê°œ','í‰ì–‘ëƒ‰ë©´','ì´ˆë°¥','íŒŒìŠ¤íƒ€','ìŠ¤í…Œì´í¬','ë–¡ë³¶ì´','êµ­ë°¥','ìƒëŸ¬ë“œ','í”¼ì','ì¹˜í‚¨','ë§ˆë¼íƒ•'],
    hobbies: ['ë…ì„œ','ì˜í™” ê°ìƒ','ì½”ë”©','í—¬ìŠ¤','ì‚°ì±…','ì‚¬ì§„ ì´¬ì˜','ì „ì‹œíšŒ ê´€ëŒ','ê²Œì„','ë“œë¼ì´ë¸Œ','ìŒì•… ê°ìƒ','ì¹´í˜ íˆ¬ì–´']
  };

  // ëœë¤ ë²„íŠ¼
  $('btnRandMbti').addEventListener('click', () => { $('mbti').value = pick(dataBank.mbti); });
  $('btnRandFood').addEventListener('click', () => { $('food').value = pick(dataBank.foods); });
  $('btnRandHobby').addEventListener('click', () => { $('hobby').value = pick(dataBank.hobbies); });

  // í…Œë§ˆ ì„ íƒ
  const swatches = document.querySelectorAll('.color-swatch');
  swatches.forEach(swatch => {
    swatch.addEventListener('click', () => {
      swatches.forEach(s => s.classList.remove('active'));
      swatch.classList.add('active');
      selectedTheme = swatch.getAttribute('data-theme');
    });
  });

  // ì´ë¯¸ì§€ ì—…ë¡œë“œ
  $('profileImg').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if(file) {
      const reader = new FileReader();
      reader.onload = function(evt) { uploadedImageSrc = evt.target.result; };
      reader.readAsDataURL(file);
    } else {
      uploadedImageSrc = null;
    }
  });

  // [Form -> Result]
  $('profileForm').addEventListener('submit', (e) => {
    e.preventDefault();
    
    const info = {
      name: $('name').value.trim(),
      mbti: $('mbti').value.toUpperCase().trim() || 'SECRET',
      food: $('food').value.trim() || 'SECRET',
      hobby: $('hobby').value.trim() || 'SECRET',
      contact: $('contactTime').value,
      tone: $('tone').value
    };

    if(!info.name) {
      showToast('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
      return;
    }

    renderCard(info);
    switchView('viewForm', 'viewResult');
  });

  // [Result -> Form (ë‹¤ì‹œ ë§Œë“¤ê¸°)]
  $('backBtn').addEventListener('click', () => {
    switchView('viewResult', 'viewForm');
  });

  function renderCard(info) {
    const cardEl = $('cardElement');
    cardEl.className = 'id-card'; 
    cardEl.classList.add(selectedTheme);

    const avatarBox = $('rAvatar');
    avatarBox.innerHTML = ''; 
    
    if(uploadedImageSrc) {
      const img = document.createElement('img');
      img.src = uploadedImageSrc;
      avatarBox.appendChild(img);
    } else {
      avatarBox.textContent = info.name.substring(0,1);
    }

    $('rName').textContent = info.name;
    $('rMbti').textContent = info.mbti;

    const tags = [info.food, info.hobby];
    if(info.contact === 'day') tags.push('ë‚®ì—°ë½ì„ í˜¸');
    if(info.contact === 'night') tags.push('ë°¤ì—°ë½ì„ í˜¸');

    const tagsContainer = $('rTags');
    tagsContainer.innerHTML = '';
    tags.forEach(t => {
      const span = document.createElement('span');
      span.className = 'tag';
      span.textContent = `#${t}`;
      tagsContainer.appendChild(span);
    });

    $('rDesc').textContent = generateText(info);
  }

  function generateText({name, mbti, food, hobby, tone, contact}) {
    const baseTemplates = {
      polite: [
        `ì•ˆë…•í•˜ì„¸ìš”, ${name}ì…ë‹ˆë‹¤. MBTIëŠ” ${mbti}ì´ë©°, í‰ì†Œ ${hobby} í™œë™ì„ ì¦ê¹ë‹ˆë‹¤. ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ìŒì‹ì€ ${food}ì…ë‹ˆë‹¤.`
      ],
      casual: [
        `ì•ˆë…•, ë‚˜ëŠ” ${name}. MBTIëŠ” ${mbti}ì•¼. ìš”ì¦˜ì€ ${food}ì— ë¹ ì ¸ìˆê³ , ì‰´ ë•ŒëŠ” ì£¼ë¡œ ${hobby} í•˜ë©´ì„œ ì‹œê°„ì„ ë³´ë‚´.`
      ],
      brief: [
        `ì´ë¦„: ${name} | MBTI: ${mbti} | ì¢‹ì•„í•˜ëŠ” ìŒì‹: ${food} | ì·¨ë¯¸: ${hobby}`
      ],
      emotional: [
        `${name}. ${mbti}ì˜ ì‹œì„ ìœ¼ë¡œ ì¼ìƒì„ ê¸°ë¡í•©ë‹ˆë‹¤. ì €ë¥¼ ${food}ì˜ ë§›ê³¼ ${hobby}ìœ¼ë¡œ ì±„ìš°ëŠ” ê²ƒì„ ì‚¬ë‘í•©ë‹ˆë‹¤.`
      ]
    };

    let text = pick(baseTemplates[tone] || baseTemplates.polite);
    let contactMsg = '';
    if(contact !== 'any') {
      if(tone === 'polite') contactMsg = contact === 'day' ? " ì—°ë½ì€ ì£¼ë¡œ ì—…ë¬´ ì‹œê°„(ë‚®)ì— ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤." : " ëŠ¦ì€ ì‹œê°„ì—ë„ í¸í•˜ê²Œ ì—°ë½ ì£¼ì…”ë„ ë©ë‹ˆë‹¤.";
      else if(tone === 'casual') contactMsg = contact === 'day' ? " ì—°ë½ì€ ë‚®ì— í•´ì¤˜!" : " ë°¤ ëŠ¦ê²Œ ì—°ë½í•´ë„ ê´œì°®ì•„.";
      else if(tone === 'brief') contactMsg = contact === 'day' ? " (ë‚® ì—°ë½ ì„ í˜¸)" : " (ë°¤ ì—°ë½ ì„ í˜¸)";
      else if(tone === 'emotional') contactMsg = contact === 'day' ? " í•´ê°€ ë–  ìˆëŠ” ì‹œê°„ì— ì†Œí†µí•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤." : " ë°¤ì˜ ê³ ìš”í•œ ì‹œê°„ì— ëŒ€í™” ë‚˜ëˆ„ê¸¸ ì¦ê¹ë‹ˆë‹¤.";
    }
    return text + contactMsg;
  }

  $('copyBtn').addEventListener('click', () => {
    navigator.clipboard.writeText($('rDesc').textContent).then(() => showToast('í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰'));
  });

  $('shareBtn').addEventListener('click', async () => {
    if (!navigator.share) {
      showToast('ì´ ë¸Œë¼ìš°ì €ëŠ” ê³µìœ  ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
      return;
    }
    showToast('ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
    const target = $('captureTarget');
    try {
      const canvas = await html2canvas(target, { backgroundColor: null, scale: 3, useCORS: true, allowTaint: true });
      canvas.toBlob(async (blob) => {
        const file = new File([blob], "profile_card.png", { type: "image/png" });
        try {
          await navigator.share({ title: 'ë‚˜ì˜ í”„ë¡œí•„ ì¹´ë“œ', text: 'ë‚˜ë§Œì˜ í”„ë¡œí•„ ì¹´ë“œë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”!', files: [file] });
          showToast('ê³µìœ  ì™„ë£Œ! âœ¨');
        } catch (err) { console.log('ê³µìœ  ì·¨ì†Œë¨'); }
      });
    } catch(e) { showToast('ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨ ğŸ˜¢'); }
  });

  $('downloadBtn').addEventListener('click', () => {
    showToast('ì´ë¯¸ì§€ ì €ì¥ ì¤‘...');
    html2canvas($('captureTarget'), { backgroundColor: null, scale: 4, logging: false, useCORS: true, allowTaint: true }).then(canvas => {
      const link = document.createElement('a');
      link.download = `${$('name').value}_profile.png`;
      link.href = canvas.toDataURL('image/png');
      link.click();
      showToast('ì €ì¥ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸ’¾');
    });
  });
});
</script>
</body>
</html>
